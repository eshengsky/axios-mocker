chrome.storage.local.get("active", value => {
    const script1 = document.createElement("script");
    script1.textContent = `
    window.__MOCKER_EXTENSIONID = '${chrome.runtime.id}';
    window.__MOCKER_ENABLED = ${value.active !== false};
`;
    script1.async = false;
    document.documentElement.appendChild(script1);
});

/** SCRIPTS TO BE REPLACE, DONT MODIFY */
const extJs = `!function(e){function o(r){if(t[r])return t[r].exports;var n=t[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}var t={};return o.m=e,o.c=t,o.p="",o(0)}([function(e,o,t){e.exports=t(4)},,,function(e,o){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={handleMockData:function(e,o,r,n,s){var a=this,c={};c.data=e.res.body;var i=e.res.contentType||"application/json";if(i.indexOf("json")>=0&&"object"!==t(c.data))try{c.data=JSON.parse(e.res.body)}catch(e){}c.status=Number(e.res.statusCode),c.statusText="",c.headers={"x-mocker-data":"true","content-type":i},e.res.headers&&"object"===t(e.res.headers)&&Object.assign(c.headers,e.res.headers),c.config=o,c.request=null,Number(e.res.delay)?setTimeout(function(){a.mockDone(c,o,r,n,s)},Number(e.res.delay)):this.mockDone(c,o,r,n,s)},mockDone:function(e,o,t,r,n){this.printMockDetails(e,o,n);var s=o.validateStatus;if(s.call(null,e.status))t(e);else{var a=new Error("Request failed with status code "+e.status);a.response=e,a.request=null,a.config=o,r(a)}},printMockDetails:function(e,o,t){console.group("%cAxiosMocker Network","color: #8a2be2"),console.log(t?"💡%c该请求返回了模拟数据，请注意在Network面板或抓包工具中无法查看真实的网络请求。模拟数据的详情如下：":"💡%cThe request returned mock data, note that the real request cannot be viewed in Network panel or capture tool. Mock data details are as follows:","color: #8a2be2; margin-left: 3px;"),console.group("General");var r=o.url;"undefined"!=typeof window&&(0===r.indexOf("//")&&(r=""+location.protocol+r),0!==r.indexOf("http")&&(r=location.protocol+"//"+location.host+r));var n=void 0;try{n=new URL(r),Object.keys(o.params||{}).forEach(function(e){n.searchParams.append(e,o.params[e])}),r=n.href}catch(e){}if(console.log("%cRequest URL:","font-weight: bold;",r),console.log("%cRequest Method:","font-weight: bold;",o.method.toUpperCase()),console.log("%cStatus Code: %c"+e.status,"font-weight: bold;",e.status>=200&&e.status<300?"color: green; font-weight: bold;":"color: orangered; font-weight: bold;"),console.groupEnd(),console.groupCollapsed("Response Headers ("+Object.keys(e.headers).length+")"),Object.keys(e.headers).forEach(function(o){console.log("%c"+o+":","font-weight: bold;",e.headers[o])}),console.groupEnd(),console.groupCollapsed("Request Headers ("+Object.keys(o.headers).length+")"),Object.keys(o.headers).forEach(function(e){console.log("%c"+e+":","font-weight: bold;",o.headers[e])}),console.groupEnd(),n){var s=Array.from(n.searchParams);s.length>0&&(console.groupCollapsed("Query String Parameters ("+s.length+")"),s.forEach(function(e){console.log("%c"+e[0]+":","font-weight: bold;",e[1])}),console.groupEnd())}if(o.data){var a=void 0,c=void 0;try{"string"==typeof o.data?(c="Form Data",a=JSON.parse('{"'+decodeURI(o.data).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}'),a.__proto__=null):(c="Request Payload",a=JSON.parse(o.data),a.__proto__=null)}catch(e){}console.groupCollapsed(c),a?console.log(a):console.log("%cParse Error!","color: #888; font-style: italic;"),console.groupEnd()}console.groupCollapsed("Response");var i=e.data;try{i=JSON.parse(i)}catch(e){}i&&i.__proto__&&(i.__proto__=null),console.log(i),console.groupEnd(),console.groupEnd()}}},function(e,o,t){"use strict";function r(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(o,t,r){return t&&e(o.prototype,t),r&&e(o,r),o}}(),s=t(3),a=function(){function e(o){return r(this,e),this.isCHN="zh-cn"===(navigator.language||"").toLowerCase(),o?(this.axios=o,void this.init()):void console.error(this.isCHN?"new AxiosMockerExt() 必须传入一个axios实例！":"new AxiosMockerExt() must pass in an axios instance!")}return n(e,[{key:"init",value:function(){window.__MOCKER_ENABLED&&(console.log(this.isCHN?"%cAxiosMocker已开启！你可以在 Chrome开发者工具 -> AxiosMocker 中编辑mock数据了。":"%cAxiosMocker now activated! You can edit the mock data in Chrome dev tools -> AxiosMocker tab.","color: green"),this.extensionId=window.__MOCKER_EXTENSIONID,this.originAdapter=this.axios.defaults.adapter,this.axios.defaults.adapter=this.mockerAdapter())}},{key:"sentErrMsg",value:function(){console.warn(this.isCHN?"向AxiosMocker扩展程序发送消息时失败，可能是没有配置mock权限，点击这里查看如何配置: https://github.com/eshengsky/axios-mocker/blob/master/README-zh.md#权限问题":"Failed to send messages to AxiosMocker extension, probably without configuring mock permissions, click here to see how to configure: https://github.com/eshengsky/axios-mocker/blob/master/README.md#permission-issue")}},{key:"mockerAdapter",value:function(){var e=this;return function(o){return new Promise(function(t,r){try{chrome.runtime.sendMessage(e.extensionId,{url:o.url,type:o.method.toUpperCase()},function(n){return chrome.runtime.lastError?(e.sentErrMsg(),void e.sendRequest(o,t,r)):void(n?s.handleMockData(n,o,t,r,e.isCHN):e.sendRequest(o,t,r))})}catch(n){e.sentErrMsg(),e.sendRequest(o,t,r)}})}}},{key:"sendRequest",value:function(e,o,t){this.originAdapter(e).then(o,t)}}]),e}();window.AxiosMockerExt=a}]);`;
/** SCRIPTS TO BE REPLACE, DONT MODIFY */

const script2 = document.createElement("script");
// script2.src = chrome.extension.getURL("dist/axios-mocker-ext.min.js");
script2.textContent = extJs;
script2.async = false;
document.documentElement.appendChild(script2);
